---
title:  "ìˆ˜í•™ì„ ëª»í•˜ë©´ ì§œê²Œ ë˜ëŠ” ì½”ë“œ"
excerpt: "ìˆ˜í•™ì  ì•„ì´ë””ì–´ 1"

categories:
  - Blog
tags:
  - [Blog, TIL, ì•Œê³ ë¦¬ì¦˜]

use_math: true
 
date: 2021-11-20
last_modified_at: 2021-11-20

---

# ìˆ˜í•™ì„ ëª»í•˜ë©´ ì§œê²Œ ë˜ëŠ” ì½”ë“œ

ë‚œ ìˆ˜í•™ì„ ì˜í•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ìˆ˜í•™ì ìœ¼ë¡œ ìƒê°í•´ì•¼ í•˜ëŠ” ë¬¸ì œë¥¼ ë§Œë‚ ë•Œ ì–´ë ¤ì›€ì„ ëŠë‚€ë‹¤. ì•Œê³ ë¦¬ì¦˜ì„ ê³µë¶€í•˜ë©´ì„œ ë‹¤ì‹œ ë³´ê³  ì‹¶ì—ˆë˜ ì½”ë“œë¥¼ ëª¨ì•„ë‘ì—ˆë‹¤.

# ì†Œìˆ˜

## ì†Œìˆ˜ íŒë³„

ì–´ë–¤ ìˆ˜ê°€ ì…ë ¥ë˜ë©´ ê·¸ ìˆ˜ê°€ ì†Œìˆ˜ì¸ì§€ íŒë‹¨í•˜ì‹œì˜¤.

**ì…ë ¥**

2ì´ìƒì˜ ìì—°ìˆ˜ê°€ ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§„ë‹¤.

**ì¶œë ¥**

ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§„ ìˆ˜ê°€ ì†Œìˆ˜ì´ë©´ "prime"ì„ ì¶œë ¥, ì†Œìˆ˜ê°€ ì•„ë‹ˆë©´ "not prime"ì„ ì¶œë ¥í•œë‹¤.

### ì¼ë°˜ì ì¸ í’€ì´

```python
def solution(x: int) -> int:
    for i in range(2, x+1):
        if x % i == 0:
            return False
    return True

if __name__ == '__main__':
    n = int(input())
    print('prime' if solution(n) else 'not prime')
```

ì‹œê°„ë³µì¡ë„ëŠ” O(n)ì´ë‹¤.



### ìˆ˜í•™ì  í’€ì´

```python
from math import sqrt

def solution(x: int) -> int:
    for i in (2, sqrt()):
        if x % i == 0:
            return False
    return True

if __name__ == '__main__':
    n = int(input())
    print('prime' if solution(n) else 'not prime')
```

ëª¨ë“  ì•½ìˆ˜ëŠ” ê°€ìš´ë° ì•½ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³±ì˜ ì—°ì‚°ì— ëŒ€í•´ ëŒ€ì¹­ì´ë‹¤.  

ex> 1, 2, 4, 8, 16 -> 2x8, 1x16  

ë”°ë¼ì„œ ê°€ìš´ë° ì•½ìˆ˜(ì œê³±ê·¼)ê¹Œì§€ë§Œ í™•ì¸í•˜ë©´ ì•½ìˆ˜ê°€ ìˆëŠ” ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  

ì‹œê°„ë³µì¡ë„ëŠ” O(sqrt(n))

## nì´í•˜ì˜ ì†Œìˆ˜ ì¶œë ¥í•˜ê¸°

ìì—°ìˆ˜ nì´ ì…ë ¥ë˜ë©´ n ì´í•˜ì˜ ì†Œìˆ˜ë¥¼ ëª¨ë‘ ì¶œë ¥í•œë‹¤.



### ì¼ë°˜ì  í’€ì´

```python
def solution(x: int) -> int:
    for i in range(2, x+1):
        if x % i == 0:
            return False
    return True

if __name__ == '__main__':
    n = int(input())
    for i in range(1, n+1):
        if solution(x):
            print(i, end=" ")
```

ì‹œê°„ë³µì¡ë„ëŠ” O(n^2)ì´ë‹¤.



### ìˆ˜í•™ì  í’€ì´

ì¤‘í•™êµì—ì„œ ë°°ì› ë˜ ì—ë¼í† ìŠ¤í…Œë„¤ìŠ¤ì˜ ì²´ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ í’€ì´í•˜ë©´ ë” ë¹ ë¥´ê²Œ í’€ ìˆ˜ ìˆë‹¤.

ì—ë ˆí† ìŠ¤í…Œë„¤ìŠ¤ì˜ ì²´ ì•Œê³ ë¦¬ì¦˜ ë™ì‘ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. 2ë¶€í„° ğ‘ê¹Œì§€ì˜ ëª¨ë“  ìì—°ìˆ˜ë¥¼ ë‚˜ì—´í•œë‹¤
2. ë‚¨ì€ ìˆ˜ ì¤‘ì—ì„œ ì•„ì§ ì²˜ë¦¬í•˜ì§€ ì•Šì€ ê°€ì¥ ì‘ì€ ìˆ˜ ğ‘–ë¥¼ ì°¾ëŠ”ë‹¤
3. ë‚¨ì€ ìˆ˜ ì¤‘ì—ì„œ iì˜ ë°°ìˆ˜ë¥¼ ëª¨ë‘ ì œê±°í•œë‹¤(ğ‘–ëŠ” ì œê±°í•˜ì§€ ì•ŠëŠ”ë‹¤)
4. ë” ì´ìƒ ë°˜ë³µí•  ìˆ˜ ì—†ì„ ë•Œê¹Œì§€ 2ë²ˆê³¼ 3ë²ˆì˜ ê³¼ì •ì„ ë°˜ë³µí•œë‹¤

```python
from math import sqrt

def getPrimelist(x: int) -> list():
    d = [False, False] + [True] * (x-1)

    for i in range(2, int(sqrt(x)+1)):
        if d[i]:
            for j in range(i+i, n, i):
                d[j] = False

    return [i for i in range(2, n) if d[i] == True]
n = int(input())
print(getPrimelist(n))
```

ì‹œê°„ ë³µì¡ë„ëŠ” ***O(NloglogN)\** ì´ë‹¤. ìˆ˜ê°€ ë§ì„ ìˆ˜ë¡ ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ìš”êµ¬í•œë‹¤.

# ìˆ˜ì—´



## 1ë¶€í„° nê¹Œì§€ í•© êµ¬í•˜ê¸°

ì…ë ¥ìœ¼ë¡œ ìì—°ìˆ˜ nì´ ì…ë ¥ëœë‹¤. (1<=n<=10,000)

1ë¶€í„° nê¹Œì§€ì˜ í•©ì„ ì¶œë ¥í•œë‹¤.

**ì…ë ¥ ì˜ˆì‹œ**

100

**ì¶œë ¥ ì˜ˆì‹œ**

5050



### ì¼ë°˜ì ì¸ í’€ì´

```python
n = int(input())
answer = 0
for i in range(n+1):
    answer += 1
print(answer)
```

ë°˜ë³µë¬¸ì„ í™œìš©í•´ì„œ í’€ì´í•  ìˆ˜ ìˆë‹¤. ì‹œê°„ë³µì¡ë„ëŠ” O(n^2)

```python
def solution(x: int) -> int:
    if x==1:
        return 1
    return x + soulution(x-1)

if __name__ == '__main__':
    n = int(input())
    print(soulution(n))
```

ì¬ê·€í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ í’€ì´í•  ìˆ˜ ìˆë‹¤. ì‹œê°„ë³µì¡ë„ëŠ” O(n)

### ìˆ˜í•™ì  í’€ì´

```python
n = int(input())
answer = n * (n+1) // 2
print(answer)
```

$$
S = \sum_{i=1}^{n} k = \frac{n(n+1)}{2}
$$

ì‹œê·¸ë§ˆ ê³µì‹ì„ ì´ìš©í•˜ì—¬ í’€ì´í•˜ë©´ ì‹œê°„ë³µì¡ë„ O(1)ë¡œ í’€ì´í•  ìˆ˜ ìˆë‹¤.



## Codeup: 3706 : ìˆ˜ì—´ì˜ í•©

ë™ë ¬ì´ëŠ” ìˆ˜í•™ ë¬¸ì œë¥¼ í’€ë‹¤ ë‹¤ìŒê³¼ ê°™ì€ ìˆ˜ì—´ì„ ë³´ì•˜ë‹¤.
$$
S_n = (1) + (1+2) +(1+2+3) + (1+2+3+4)+...(1+...+n)
$$
ì„ì˜ì˜ ì •ìˆ˜ nì´ ì£¼ì–´ì§ˆ ë•Œ ì´ ìˆ˜ì—´ì˜ í•© Snì„ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.

**ì…ë ¥**

nì´ ì…ë ¥ëœë‹¤. (n<=50)

**ì¶œë ¥**

ìˆ˜ì—´ì˜ í•© Snì˜ ê°’ì„ ì¶œë ¥í•œë‹¤.

**ì…ë ¥ ì˜ˆì‹œ**  ì˜ˆì‹œ ë³µì‚¬

5

**ì¶œë ¥ ì˜ˆì‹œ**

35



### ì¼ë°˜ì ì¸ í’€ì´

``` python
answer = 0
for i in range(1, int(input()) + 1):
    tmp = 0
    for j in range(1, i+1):
        tmp += j
    answer += tmp

print(answer)
```

ì‹œê°„ ë³µì¡ë„ëŠ” O(n^2)ì´ ëœë‹¤.

### ìˆ˜í•™ì  í’€ì´

ìˆ˜ì—´ì„ ë‚˜ì—´í•´ íŒ¨í„´ì„ íŒŒì•…í•´ë³´ì
$$
\{a_n\} \;\;\;\;1\;\;\;\;\;\;\;\;\;\;3\;\;\;\;\;\;\;\;\;\;6\;\;\;\;\;\;\;\;\;\;10\\
\{b_n\} \;\;\;\;\;\;\;\;\;\;2\;\;\;\;\;\;\;\;\;3\;\;\;\;\;\;\;\;\;\;\;4\;\;\;\;\;\;\;\;\\
b_n = n + 1
$$
An ì˜ í˜•íƒœë¡œëŠ” ê·œì¹™ì„ ì°¾ê¸° ì–´ë µì§€ë§Œ Bnì˜ í˜•íƒœë¡œëŠ” ë“±ì°¨ìˆ˜ì—´ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.   

ì¦‰, ê³„ì°¨ìˆ˜ì—´ì´ë¯€ë¡œ ê³„ì°¨ìˆ˜ì—´ì˜ ì¼ë°˜í•­ì„ êµ¬í•˜ëŠ” ë°©ë²•ëŒ€ë¡œ ê³„ì‚°í•´ì¤€ë‹¤.  
$$
a_n = a_1 +\sum_{i=1}^{n-1} b_n = a_1 +\sum_{i=1}^{n-1} (k+1) \\
= 1 + \frac{n(n+1)}{2} + (n-1)\\
ì‹ì„\;ì •ë¦¬í•˜ë©´\\
a_n = \frac{n^2+n}{2}
$$
ë¬¸ì œì—ì„œëŠ” ìˆ˜ì—´ì˜ í•©ì„ êµ¬í•˜ë¼ í–ˆìœ¼ë¯€ë¡œ Snì„ êµ¬í•˜ë©´
$$
S_n =\sum_{i=1}^{n} \frac{k^2+k}{2}\\
=  \frac{1}{2}(\frac{n(n+1)(2n+1)}{6} + \frac{n(n+1)}{2})\\ì‹ì„\;ì •ë¦¬í•˜ë©´\\
S_n= \frac{n^3+3n^2+2n}{6}
$$
ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì½”ë”©í•  ìˆ˜ ìˆë‹¤. 

```python
n = int(input())print(f"{(n**3 + 3*n**2 + 2*n) // 6}")
```

ì‹œê°„ë³µì¡ë„ëŠ” O(1)

## Codeup: 2723 : 5ê°ìˆ˜ (Large)

5ê°í˜•ì„ ë‹¤ìŒê³¼ ê°™ì´ ê·¸ë ¤ë‚˜ê°„ë‹¤.   

ë‹¤ìŒê³¼ ê°™ì€ ì‹ìœ¼ë¡œ 5ê°í˜•ì´ ê·¸ë ¤ì§ˆ ë•Œ në²ˆì§¸ 5ê°í˜•ì˜ ì ì˜ ìˆ˜ë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.   

![5ê°ìˆ˜ê·¸ë¦¼](https://codeup.kr/upload/201706/173.jpg)

<span style="color:red">**ìˆ«ìê°€ ë„ˆë¬´ ì»¤ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ nnë²ˆì§¸ 5ê°í˜•ì˜ ì ì˜ ê°œìˆ˜ì— 1,000,000,004ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.**</span>

**ì…ë ¥**

ì²«ì§¸ ì¤„ì— n(1â‰¤nâ‰¤10,000,000)ì´ ì…ë ¥ëœë‹¤.



**ì¶œë ¥**

në²ˆì§¸ 5ê°í˜•ì˜ ì ì˜ ê°œìˆ˜ì— 1,000,000,004ë¥¼ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.

**ì…ë ¥ ì˜ˆì‹œ**  ì˜ˆì‹œ ë³µì‚¬

3

**ì¶œë ¥ ì˜ˆì‹œ**

22

### ì¼ë°˜ì ì¸ í’€ì´

```python
n = int(input())d = 2; answer = n * 5 for i in range(2, n+1):  answer += d  d += 3print(answer)
```

### ìˆ˜í•™ì  í’€ì´

5ê°í˜•ì˜ ì ì˜ ê°œìˆ˜ë¥¼ ìˆ˜ì—´ë¡œ ë‚˜íƒ€ë‚´ê³  ê·¸ ìˆ˜ì—´ì„ Anì´ë¼ í•œë‹¤ë©´
$$
\{a_n\}\;\;\;5\;\;\;\;\;\;\;12\;\;\;\;\;\;\;22\\
\{b_n\}\;\;\;\;\;\;\;\;7\;\;\;\;\;\;\;\;10\;\;\;\;
$$
Bn = 3n + 4ë¥¼ ê°€ì§€ëŠ” ê³„ì°¨ìˆ˜ì—´ì„ ê°€ì§€ê²Œ ëœë‹¤.

ì¼ë°˜í•­ì„ ê³„ì‚°í•œë‹¤ë©´
$$
a_n = a_1 +\sum_{i=1}^{n-1} b_n = a_1 +\sum_{i=1}^{n-1} (3k+4)\\
= 5 + 3(\frac{n(n+1)}{2}) + 4(n-1)\\
ì‹ì„\;ì •ë¦¬í•˜ë©´\\
a_n = \frac{3n^2+5n+2}{2}
$$
ë”°ë¼ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
n = int(input())answer = (3*n**2 + 5*n + 2) // 2 print(answer % 1000000004)
```

ì‹œê°„ë³µì¡ë„ëŠ” O(1)

## Codeup: 2753 : ìˆ˜ì—´ì˜ në²ˆì§¸ í•­

ìœ ì‚¬ ë¬¸ì œ :  [ë°±ì¤€ 14440 ì •ìˆ˜ ìˆ˜ì—´](https://www.acmicpc.net/problem/10799) 

KDSëŠ” ì í™”ì‹ì— ê´€ì‹¬ì´ ë§ë‹¤.

ê·¸ë˜ì„œ í”„ë¡œê·¸ë˜ë°ì„ ì´ìš©í•´ì„œ ì–´ë–¤ ì í™”ì‹ì´ ì£¼ì–´ì¡Œì„ ë•Œ, ê·¸ ìˆ˜ì—´ì˜ nnë²ˆì§¸í•­ì„ êµ¬í•˜ê³  ì‹¶ë‹¤.

ì´ì œ ì í™”ì‹ì— ëŒ€í•œ ì •ë³´ê°€ ì£¼ì–´ì§ˆ ë•Œ, nnë²ˆì§¸í•­ì„ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì§œì„œ KDSë¥¼ ë„ì™€ì£¼ì.

êµ¬í•˜ê³ ì í•˜ëŠ” ìˆ˜ì—´ì˜ ì í™”ì‹ì´
$$
F_n=m_1âˆ—F_{nâˆ’1}+m_2âˆ—F_{nâˆ’2}
$$
ìœ„ì™€ ê°™ì„ ë•Œ, ì œ 00í•­ aa,ì œ 11í•­ bb, ê·¸ë¦¬ê³  ì í™”ì‹ì—ì„œì˜ ê³„ìˆ˜ m1, m2ì´ ê³µë°±ìœ¼ë¡œ ì£¼ì–´ì§„ë‹¤. ê·¸ë¦¬ê³  nnì´ ì£¼ì–´ì§„ë‹¤.

ì´ ë•Œ nnë²ˆì§¸ í•­ì˜ ê°’ì„ ì¶œë ¥í•˜ë˜ 1,000,000,007ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•˜ì‹œì˜¤.

**ì…ë ¥**

ì œ 0í•­ a, ì œ 1í•­ b, ê·¸ë¦¬ê³  ì„ í˜•ì í™”ì‹ì—ì„œì˜ ê³„ìˆ˜ m1, m2ì™€ ìì—°ìˆ˜ nì´ ê³µë°±ìœ¼ë¡œ ì…ë ¥ëœë‹¤.

(ë‹¨, nì€ 100,000,000,000ë³´ë‹¤ ê°™ê±°ë‚˜ ì‘ë‹¤. a,b,m1,m2ëŠ” 100ì´í•˜ì˜ ìì—°ìˆ˜. )

**ì¶œë ¥**

në²ˆì§¸ í•­ì„ ì¶œë ¥í•˜ë˜, 1,000,000,007ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.

**ì…ë ¥ ì˜ˆì‹œ**

0 1 2 1 2

**ì¶œë ¥ ì˜ˆì‹œ**

2

### í’€ì´

ë³´ìë§ˆì ê³ ë“±í•™êµ ë•Œì²˜ëŸ¼ ê·¸ëƒ¥ ì¼ë°˜í•­ì„ ë§Œë“¤ì–´ì„œ í’€ì´í•˜ë©´ ë˜ì§€ ì•Šë‚˜? í˜¹ì€ ë°˜ë³µë¬¸ì„ ëŒë ¤ì„œ ê°’ì„ êµ¬í•˜ë©´ ë˜ì§€ ì•Šëƒê³  í•  ê²ƒì´ë‹¤.  

í‰ë²”í•˜ê²Œ í’€ì´í•˜ë©´ ì–´ë–¤ ë¬¸ì œê°€ ìƒê¸°ëŠ” ì§€ ì•Œì•„ë³´ì.  

í•˜ì§€ë§Œ nì´ ì²œì–µê°œê°€ ë“¤ì–´ì˜¤ê³  ì¼ë°˜ì ì´ê²Œ O(N)ì˜ ì‹œê°„ìœ¼ë¡œ ë°˜ë³µë¬¸ì„ ëŒë¦°ë‹¤ë©´ ì‹œê°„ì´ˆê³¼ì™€ ë©”ëª¨ë¦¬ ì´ˆê³¼ íŒì •ì„ ë°›ê²Œ ëœë‹¤.  



ì´ ë¬¸ì œëŠ” í–‰ë ¬ì„ ì´ìš©í•˜ì—¬ í’€ì–´ì•¼í•œë‹¤.  

ì í™”ì‹ì´ ì„ í˜•ë°©ì •ì‹ í˜•íƒœë¥¼ ë³´ì¸ë‹¤ë©´ í–‰ë ¬ì˜ ê±°ë“­ì œê³±ì„ í†µí•´ ë¹ ë¥´ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤.  

ì—¬ê¸°ì„œ ì„ í˜•ë°©ì •ì‹ì´ë€ ìˆ˜ì—´ì˜ ì í™”ì‹ì´....    
$$
a_{n+d}=\sum_{i=0}^{d-1}c_i a_{n+i}+f(n)\quad(c_0\ne 0)
$$
ê¼´ë¡œ í‘œí˜„ë  ë•Œ ì´ ì‹ì˜ ì°¨ìˆ˜ dì¸ ì„ í˜•ì í™”ì‹ì´ë¼ í•˜ë©° **Linear** í•˜ê¸° ë•Œë¬¸ì— **additivity**, **Homogeneity** í•œ ì„±ì§ˆì„ ë§Œì¡±í•œë‹¤.  

í–‰ë ¬ì˜ ë¶„í• ì œê³±ì€ [í”¼ë³´ë‚˜ì¹˜ ì™„ë²½ ì •ë¦¬/ë¶„í•  ì •ë³µ](https://co1dtype.github.io/blog/%ED%94%BC%EB%B3%B4%EB%82%98%EC%B9%98-%EC%88%98%EC%97%B4-%EC%99%84%EB%B2%BD-%EC%A0%95%EB%A6%AC/#%EB%B6%84%ED%95%A0-%EC%A0%95%EB%B3%B5) ì— ì •ë¦¬í•´ë‘ì—ˆìœ¼ë‹ˆ ì„ í–‰ ì§€ì‹ì´ ì—†ìœ¼ë©´ ë³´ê³  ì˜¤ë„ë¡ í•˜ì.  



ì…ë ¥ ì˜ˆì‹œì˜ ì„ í˜•ì í™”ì‹ì„ í–‰ë ¬ë¡œ í‘œí˜„í•´ë³´ìë©´....  
$$
\begin{bmatrix}F_n\\F_{n-1}\\ \end{bmatrix}=\begin{bmatrix}1&2\\1&0\\ \end{bmatrix} ^ {n-1}\begin{bmatrix}F_{n-1}\\F_{n-2}\\ \end{bmatrix}
$$
ì¦‰, ì¼ë°˜í•­ì„ ì°¾ì•„ë³´ìë©´
$$
\begin{bmatrix}F_n\\F_{n-1}\\ \end{bmatrix}=\begin{bmatrix}m_1&m_2\\1&0\\ \end{bmatrix}^ {n-1}\begin{bmatrix}F_1\\F_0\\ \end{bmatrix}
$$
ë¶„í•  ì •ë³µì„ í†µí•´ í–‰ë ¬ì˜ ê±°ë“­ì œê³±ì„ ë¹¨ë¦¬ ì§„í–‰í•´ í’€ì´í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.  

```python
import sysinput = sys.stdin.readlineMOD = 1000000007def power(m, y):    if y == 1:        return m    partial = power(m, y // 2)    partial_square = multi(partial, partial)    if y % 2 == 0:        return partial_square    elif y % 2 == 1:        return multi(partial_square, m)def multi(matrix_1, matrix_2):    length = len(matrix_1)    result = [[0 for _ in range(length)] for _ in range(length)]    for i in range(length):        for j in range(length):            result[i][j] = sum([(matrix_1[i][k] * matrix_2[k][j])%MOD for k in range(length)])%MOD    return resultif __name__ == '__main__':    a0, a1, x, y, n = map(int, input().split())    matrix = [[x, y], [1, 0]]    if n <= 1:        answer = [a0, a1][n] % MOD        print(answer)    else:        tmp = power(matrix, n-1)        answer = (tmp[0][0] * a1 + tmp[0][1]*a0) % MOD        print(answer)
```

# ì´í•­ ê³„ìˆ˜

## Codeup: 3720 : nCr (Hell)

**ë¬¸ì œ ì„¤ëª…**  

nCrì„ 1999ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ êµ¬í•˜ì—¬ë¼.



**ì…ë ¥**

ì²«ì§¸ ì¤„ì— n, rì´ ì£¼ì–´ì§„ë‹¤. ( 0 <= r <= n <= 1,000,000,000 )

**ì¶œë ¥**

nCrì„ 1999ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.



**ì…ë ¥ ì˜ˆì‹œ**

5 3

**ì¶œë ¥ ì˜ˆì‹œ**

10



### í’€ì´


$$
{}_n{\rm C}_r = {}_{n-1}{\rm C}_{r-1} + {}_{n-1}{\rm C}_{r}
$$


ì¡°í•©ì˜ ì„±ì§ˆì„ ì´ìš©í•˜ì—¬ ë¬¸ì œ í’€ì´ë¥¼ í•œë‹¤.  ì‹œê°„ì„ ë” ì¤„ì´ê¸° ìœ„í•´ DPë¥¼ ì‚¬ìš©í•˜ì—¬ í’€ì´í•œë‹¤. 



```python
import sysinput = sys.stdin.readlined = [[0 for i in range(31)] for j in range(31)]def nCr(n: int, r: int):    if n==r or r==0:        return 1    if d[n][r] ^ 0:        return d[n][r]        d[n][r] = nCr(n-1, r) + nCr(n-1, r-1)    return d[n][r]if __name__ == '__main__':    a, b = map(int, input().split())    print(nCr(a, b))
```



í•˜ì§€ë§Œ nì´ 1,000,000,000ì´ ë“¤ì–´ì˜¨ë‹¤ë©´ ë©”ëª¨ë¦¬ ì´ˆê³¼ íŒì •ì„ ë°›ê²Œ ëœë‹¤. 

ì¼ë°˜ì ì¸ ë°©ë²•ìœ¼ë¡œ í’€ì´í•˜ë©´ ì‹œê°„ ì´ˆê³¼ë¥¼ ë°›ëŠ” ë¬¸ì œë‹¤.  ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ?  



ì¡°í•©ë¡ ì—ì„œ ë¤¼ì¹´ì˜ ì •ë¦¬ë¥¼ ì‚¬ìš©í•´ ê°„í¸í•˜ê²Œ í’€ì´í•  ìˆ˜ ìˆë‹¤.  
$$
{}_m{\rm C}_n = \prod_{i=0}^{k}{}_{m_i}{\rm C}_{n_i} \;(mod\;\,p),
$$
ì—¬ê¸°ì„œ mê³¼ nì€ mê³¼ nì„ pì§„ë²•ìœ¼ë¡œ ì „ê°œí•œ ì‹ì´ë‹¤.
$$
m = m_kp^k + m_{k-1}p^{k-1} + ... + m_{1}p +m_0\\
n = n_kp^k + n_{k-1}p^{k-1} + ... + n_{1}p +n_0
$$
ì´ë–„ m_i < n_i ì´ë©´ {}_m{\rm C}_n = 0 ì·¨ê¸‰í•œë‹¤.    

ìœ„ì˜ ì„±ì§ˆì„ ì´í•´í–ˆë‹¤ë©´ ì´ ë¬¸ì œë¥¼ í’€ê¸° ë§¤ìš° ì‰¬ì›Œì§„ë‹¤.   

1999ëŠ” ì†Œìˆ˜ì´ë¯€ë¡œ ë¤¼ì¹´ ì •ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì†ŒìŠ¤ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.   

```python
from math import factorialdef nCr(n, r):    if r > n:        return 0    else:        return factorial(n)//factorial(r)//factorial(n-r)m = 1999n, k = map(int, input().split())ans = 1while n > 0:    ans = ans*nCr(n % m, k % m) % m    n //= m    k //= mprint(ans)
```

## ë°±ì¤€ 11401 ì´í•­ ê³„ìˆ˜ 3

**ë¬¸ì œ**

ìì—°ìˆ˜ N\(ê³¼ ì •ìˆ˜ Kê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì´í•­ ê³„ìˆ˜ {}_n{\rm C}_rë¥¼ 1,000,000,007ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.

**ì…ë ¥**

ì²«ì§¸ ì¤„ì— Nê³¼ Kê°€ ì£¼ì–´ì§„ë‹¤. (1 â‰¤ N â‰¤ 4,000,000, 0 â‰¤ K â‰¤ N)

**ì¶œë ¥**

 {}_n{\rm C}_rë¥¼ 1,000,000,007ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.

### í’€ì´

ì „ nCr ë¬¸ì œì™€ ê°™ì€ ì´ìœ ë¡œ ì¡°í•© ì„±ì§ˆì„ ì´ìš©í•œ ì¬ê·€í•¨ìˆ˜ í’€ì´ë¥¼ í•˜ë©´ ì‹œê°„ ì´ˆê³¼ê°€ ëœ¬ë‹¤. O(n^2) (DP x)   
$$
{}_n{\rm C}_r=\frac{{}_n{\rm P}_r}{r!}=\frac1{r!}\frac{n!}{(n-r)!}
$$
ë”°ë¼ì„œ ì¡°í•© ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ì„œ ë¬¸ì œ í’€ì´ë¥¼ í•´ì•¼í•œë‹¤.  íŒ©í† ë¦¬ì–¼ ê°’ì„ ë¯¸ë¦¬ ë©”ëª¨ì´ì œì´ì…˜í•˜ì—¬ ì‹œê°„ ë³µì¡ë„ë¥¼ ì¤„ì¸ë‹¤.   

í•˜ì§€ë§Œ ì´ë ‡ê²Œ í’€ì´í•˜ë©´ ë¬¸ì œê°€ ìƒê¸´ë‹¤. ë¶„ëª¨ê°€ 1,000,000,007ë¡œ ë‚˜ëˆ„ì—ˆì„ ë•Œ ë‚˜ëˆ„ì–´ë–¨ì–´ì§„ë‹¤ë©´ ë¶„ëª¨ê°€ 0ì´ ë˜ì–´ 0ìœ¼ë¡œ ë‚˜ëˆ ì§€ëŠ” (ZeroError) ë¶ˆìƒì‚¬ê°€ ë°œìƒí•œë‹¤.   

ë”°ë¼ì„œ í˜ë¥´ë§ˆì˜ ì†Œì •ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ í’€ì´í•œë‹¤.  

ì—¬ê¸°ì„œ í˜ë¥´ë§ˆì˜ ì†Œì •ë¦¬ëŠ” 

Pê°€ ì†Œìˆ˜ì´ê³  aê°€ pë¡œ ë‚˜ëˆ„ì–´ ë–¨ì–´ì§€ì§€ ì•ŠëŠ” ì •ìˆ˜ì´ë©´  
$$
a^{p-1}\equiv 1\left({\rm mod}\ p\right)
$$
ê·¸ë¦¬ê³ , ëª¨ë“  aì— ëŒ€í•˜ì—¬
$$
a^{p}\equiv a\left({\rm mod}\ p\right)
$$
ì—¬ê¸°ì„œ ì‹ì„ ë§Œì ¸ë³´ìë©´  
$$
a^{p-1} = a Ã—a^{p-2}\equiv 1\left({\rm mod}\ p\right)
$$
ë¥¼ ìœ ë„í•  ìˆ˜ ìˆë‹¤.  ì¦‰ ëª¨ë“ˆëŸ¬ pì— ëŒ€í•´ aì˜ ì—­ì›ì´ a^{p-2}ê°€ ëœë‹¤ëŠ” ì˜ë¯¸ë‹¤.  



ë‹¤ì‹œ ë¬¸ì œë¡œ ëŒì•„ì™€ n!ë¥¼ A, r!(n-r)!ë¥¼ Bë¼ê³  í•˜ì.  
$$
(A/B)\;mod\;p\\=A Ã—B^{-1}\;mod\;p\\= AÃ—B^{-1} Ã—B^{p-1 }\;mod\;p\\= A Ã— B^{p-2}\;mod\;p
$$
ë”°ë¼ì„œ ì—­ì›ì„ ê³±í•´ 1ì„ ë§Œë“¤ì–´ ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.

```python
import sysinput = sys.stdin.readlinedef power(A, B):    if(B % 2 > 0):        return power(A, B - 1) * A    elif(B == 0):        return 1    elif(B == 1):        return A    else:        result = power(A, B//2)        return result ** 2 % pN, K = map(int, input().split())    p =  1000000007fact = [1 for _ in range(N+1)]for i in range(2, N+1):    fact[i] = (fact[i-1] * i) % pA = fact[N]B = (fact[N - K] * fact[K]) % pprint((A % p) * (power(B, p-2) % p) % p )
```

